# GeoPandas Python Project

## Author
Falk Meyer <fmeyer.ms@gmail.com>, 2021/03/21

## Solution description

### Abstract
The given python script provides a solution approach to
determining all positively affected buildings from a highway tunnel construction. Therefore, it reads a road vector
shape file, a tunnel shape file and a shape file of possibly affected buildings obtained 
via OpenStreetMap (see [Sources](#sources)) and uses the python package GeoPandas (see [Requirements](#requirements)) for 
spatial operations on the given datasets.

### Sources
<a name="sources"></a>
* Road vector shape file (needs to be provided)
* Tunnel shape file provided by task author (needs to be provided)
* Partial buildings shape file of Rotterdam (NL) obtained via <https://extract.bbbike.org/>

### Results

Results of the script can be found under the *target* folder:
* **AnalysisReport.pdf**: The result report in pdf format
* **affectedBuildings**: The shape file of the positively affected buildings
  
## Technical description

### Requirements
<a name="requirements"></a>
The following technical requirements are to be met for successfull execution of the script:
* Python 3 (tested with Python 3.7.10)
* Python packages
    * [Geopandas](https://geopandas.org/) 0.9.0, for installation with conda use: `conda install --channel conda-forge geopandas`
    * Geopandas dependencies (included when installing Geopandas): pandas, fiona, shapely, pyproj, rtree
    * Matplotlib


### Execution
#### Input
The necessary files should be placed in the *data* folder of the project.
#### Output
The output files are placed in the *target* folder.
#### Configuration
The configuration can be adjusted in the *main.py* file lines 16-21:
```python
dataFolder = './data'
buildingsPath = os.path.join(dataFolder,'buildings')
buildingsIdField = 'osm_id'
tunnelPath = os.path.join(dataFolder,'tunnel')
highwayPath = os.path.join(dataFolder,'highway')
projCrs = 32632
```

| Name      | Description |
| ----------- | ----------- |
| dataFolder | The folder of input files |
| buildingsPath | The path to the buildings shape file |
| buildingsIdField | The unique ID field in the buildings shape file |
| tunnelPath | The path to the tunnel shape file |
| highwayPath | The path to the road vector shape file |
| projCrs | The epsg code of the projected coordinate system used for computations |

#### Script
Run the script by the following command line execution:
```python
python main.py
```

#### Logging
All logged statements are written on the command line.

### Tests

All unit tests can be executed via the following command:
```python
python -m unittest discover
```
A single unit test class can be executed as follows:
```python
python -m unittest test_analysisUtils.test_AnalysisPlotter
python -m unittest test_analysisUtils.test_SpatialAnalysisCase
```

## Project Structure
The following folder structure is in place:
```
project
│   README.md: The project Documentation
│   main.py: The main script
│
└───analysisUtils: The package providing the analysis logic and plotting classes
│   │   AnalysisCase.py: The base class for all analysis cases
│   │   AnalysisPlotter.py: The class for plotting analysis results in a pdf
│   │   SpatialAnalysisCase.py: The class for a spatial analysis case as needed in the given task
│   
└───data: The input folder
    │   buildings: shape file
    │   highway: shape file
    │   tunnel: shape file
│ 
└───doc: The folder containing the project documentation generated by doxygen
│   
└───target: The output folder
    │   AnalysisReport: pdf file
    │   affectedBuildings: shape file
│   
└───test_analysisUtils: The unit test package for the analysisUtils package
    │   test_AnalysisPlotter: unit test class for AnalysisPlotter class
    │   test_SpatialAnalysisCase: unit test class for SpatialAnalysisCase class
```

## Additional documentation
Additional documentation was automatically created with [doxygen](https://www.doxygen.nl/index.html) and can be displayed as html [here](./doc/html/index.html).